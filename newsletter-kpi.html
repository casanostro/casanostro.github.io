<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta content="ie=edge" http-equiv="x-ua-compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Newsletter KPI ‚Äì Supply (G√©n√©r√© le 25/12/2025 16:32)</title>
<style>
  :root {
    --tile-bg: #f8fafc;
    --tile-bd: #e5e7eb;
    --tile-fg: #0f172a;
    --tile-sub:#6b7280;
    --ink:#0c0c0d; --muted:#6b7280; --bd:#e5e7eb; --head:#111827; --bg:#ffffff;
    --s1:#ef4444; --s2:#f59e0b; --s3:#d97706; --s4:#10b981; --s5:#059669;
    --d1:#fda4af; --d2:#93c5fd; --d3:#60a5fa; --d4:#3b82f6; --d5:#1d4ed8;
  }
  body { font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif; color:#111827; background:#fff; margin:0; padding:0; }
  .wrapper { width:100%; padding:20px 0; background:#f6f7fb; }
  .container { width:680px; margin:0 auto; background:#ffffff; border:1px solid #e5e7eb; }
  .header { padding:16px 24px; border-bottom:1px solid #e5e7eb; }
  .h1 { font-size:18px; line-height:24px; font-weight:bold; color:#111827; }
  .badge { display:inline-block; padding:2px 8px; font-size:11px; background:#eef2ff; color:#3730a3; border-radius:12px; margin-left:8px; }
  .content { padding:16px 24px 12px 24px; color:#111827; }
  .kpi-card { border:1px solid #e5e7eb; border-radius:8px; padding:12px; }
  .kpi-title { font-size:12px; color:#6b7280; margin:0 0 6px 0; }
  .kpi-value { font-size:26px; font-weight:bold; margin:0; display:inline-block; padding:8px 30px; background:#fafafa; }
  .hr { height:1px; background:#e5e7eb; margin:16px 0; }
  .chart-title { font-size:14px; font-weight:bold; margin:0 0 10px 0; }
  .tiles-grid-table { width:100%; }
  .tile-card { width:100%; border:1px solid #e5e7eb; border-radius:10px; margin-bottom:8px; }
  .tile-left { width:44%; padding:8px 10px; vertical-align:middle; }
  .tile-right { width:56%; padding:6px 8px; vertical-align:middle; }
  .tile-name { font-size:12px; color:#6b7280; }
  .tile-value { font-size:20px; font-weight:bold; color:#111827; }
  .tile-flopfamille1 {font-size: 11px; margin: 2px 0; color:#db6a0e}
  .tile-flopfamille2 {font-size: 11px; margin: 2px 0; color:#2e48da}
  .tile-flopfamille3 {font-size: 11px; margin: 2px 0; color:#68625d}
  .tile-title {font-size: 12px; margin: 4px 0; color:#000000; font-weight:bold;}
  h1 { font-size:14px; margin:8px 0 4px 10px; color:#374151; }

  /* Couleurs des KPI */
  .band-s1 { color:#a80404 !important; }
  .band-s2 { color:#f50b0b !important; }
  .band-s3 { color:#e07a06 !important; }
  .band-s4 { color:#10b981 !important; }
  .band-s5 { color:#059669 !important; }
  .band-na { color:#6b7280 !important; }
  .delta-pos { color:#059669 !important; font-weight:700; }
  .delta-neg { color:#ef4444 !important; font-weight:700; }

  /* Page 2 - Tableau d√©taill√© */
  .wrap { max-width:1320px; margin:0 auto; padding:18px; }
  table { width:100%; border-collapse:collapse; margin-bottom:16px; }
  thead th { font-size:12px; text-transform:uppercase; letter-spacing:.06em; text-align:left; padding:8px 10px; color:#374151; border-bottom:1px solid var(--bd); background:#f9fafb; }
  tbody td { padding:8px 10px; border-bottom:1px solid var(--bd); font-size:13px; vertical-align:middle; }
  .num { text-align:right; font-variant-numeric:tabular-nums; }
  .cat-row td { background:#fcfcfd; font-weight:700; }
  .b-s1,.b-s2,.b-s3,.b-s4,.b-s5,.b-d1,.b-d2,.b-d3,.b-d4,.b-na { display:inline-block; min-width:64px; text-align:center; border-radius:6px; padding:3px 6px; font-weight:700; }
  .b-s1 { background:#ef4444; color:white }
  .b-s2 { background:#f59e0b; color:black }
  .b-s3 { background:#d97706; color:white }
  .b-s4 { background:#10b981; color:white }
  .b-s5 { background:#059669; color:white }
  .b-d1 { background:#fda4af; color:#000 }
  .b-d3 { background:#60a5fa; color:white }
  .b-na { background:#e5e7eb; color:#111827 }
  .sub { color:#6b7280; font-size:12px; }

  /* Styles pour les commentaires */
  .comment-input {
    width: 100%;
    min-width: 200px;
    padding: 6px 8px;
    border: 1px solid #e5e7eb;
    border-radius: 4px;
    font-size: 12px;
    font-family: inherit;
    transition: border-color 0.2s;
  }
  .comment-input:focus {
    outline: none;
    border-color: #3b82f6;
    background-color: #f0f9ff;
  }
  .comment-input.has-value {
    background-color: #f0fdf4;
    border-color: #10b981;
  }

  /* Toolbar pour les actions */
  .comment-toolbar {
    position: sticky;
    top: 0;
    background: #ffffff;
    border-bottom: 2px solid #e5e7eb;
    padding: 12px 18px;
    display: flex;
    gap: 10px;
    align-items: center;
    z-index: 100;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  }
  .btn {
    padding: 8px 16px;
    border: 1px solid #d1d5db;
    border-radius: 6px;
    background: #ffffff;
    color: #374151;
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
  }
  .btn:hover {
    background: #f9fafb;
    border-color: #9ca3af;
  }
  .btn-primary {
    background: #3b82f6;
    color: white;
    border-color: #3b82f6;
  }
  .btn-primary:hover {
    background: #2563eb;
    border-color: #2563eb;
  }
  .btn-success {
    background: #10b981;
    color: white;
    border-color: #10b981;
  }
  .btn-success:hover {
    background: #059669;
    border-color: #059669;
  }
  .status-msg {
    margin-left: auto;
    font-size: 12px;
    color: #6b7280;
    font-style: italic;
  }
  .status-msg.success {
    color: #10b981;
  }

  @media print {
    @page { size: A4 landscape; margin: 10mm; }
    .page-break { page-break-before: always; }
    .comment-toolbar { display: none; }
  }
  @media only screen and (max-width: 700px) {
    .container { width:100% !important; }
    .tiles-grid-table td { display:block; width:100% !important; }
  }
</style>
</head>
<body>

<!-- ========== PAGE 1 : Dashboard KPI ========== -->
<div class="wrapper">
<table border="0" cellpadding="0" cellspacing="0" class="container" role="presentation">
<tr>
<td class="header">
<div class="h1">KPI Supply ‚Äì Franprix <span class="badge">Auto-g√©n√©r√©</span></div>
</td>
</tr>
<tr>
<td class="content">

<!-- KPIs Globaux -->
<table border="0" cellpadding="0" cellspacing="0" role="presentation" width="100%">
<tr>
<td class="kpi-card" style="width:33%">
  <div class="kpi-title">Taux de service global</div>
  <div class="kpi-value band-s3">94.5%</div>
</td>
<td class="kpi-card" style="width:33%">
  <div class="kpi-title">√âvolution sur les derni√®res semaines</div>
  <div class="kpi-value"><span class="delta-pos">+1.6%</span></div>
</td>
<td class="kpi-card" style="width:33%">
  <div class="kpi-title">Moyenne des semaines</div>
  <div class="kpi-value band-s3">94.1%</div>
</td>
</tr>
</table>

<div class="hr"></div>

<!-- Entrep√¥ts -->
<div class="chart-title">Entrep√¥ts</div>
<table border="0" cellpadding="6" cellspacing="0" class="tiles-grid-table" role="presentation" width="100%">
<tr>
<td valign="top" width="33.33%"><table border="0" cellpadding="0" cellspacing="0" class="tile-card" role="presentation">
<tr>
<h1>Sec</h1>
<td class="tile-left">
<div class="tile-name">Chennevieres</div>
<div class="tile-value band-s3">94.6%</div>
</td>
<td class="tile-right">
<svg aria-label="sparkline" height="52" role="img" viewBox="0 0 180 52" width="180" xmlns="http://www.w3.org/2000/svg">
<defs>
<linearGradient id="grad_39" x1="0" x2="0" y1="0" y2="1">
<stop offset="0%" stop-color="#1f77b4" stop-opacity="0.18"></stop>
<stop offset="100%" stop-color="#1f77b4" stop-opacity="0"></stop>
</linearGradient>
</defs>
<path d="M 15 44 L 15 12 L 65 40 L 115 16 L 165 26 L 165 44 Z" fill="url(#grad_39)" stroke="none"></path>
<path d="M 15 12 L 65 40 L 115 16 L 165 26" fill="none" stroke="#1f77b4" stroke-linecap="round" stroke-width="2"></path>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="8">95.4%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="34">93.8%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="10">95.1%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="20">94.6%</text>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="50">S45</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="50">S46</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="50">S48</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="50">Total</text>
<circle cx="165" cy="26" fill="#1f77b4" r="3.2"></circle>
</svg>
</td>
</tr>
</table></td>
<td valign="top" width="33.33%"><table border="0" cellpadding="0" cellspacing="0" class="tile-card" role="presentation">
<tr>
<h1>Surgel√©</h1>
<td class="tile-left">
<div class="tile-name">Orlygel Fp</div>
<div class="tile-value band-s3">94.5%</div>
</td>
<td class="tile-right">
<svg aria-label="sparkline" height="52" role="img" viewBox="0 0 180 52" width="180" xmlns="http://www.w3.org/2000/svg">
<defs>
<linearGradient id="grad_1653" x1="0" x2="0" y1="0" y2="1">
<stop offset="0%" stop-color="#1f77b4" stop-opacity="0.18"></stop>
<stop offset="100%" stop-color="#1f77b4" stop-opacity="0"></stop>
</linearGradient>
</defs>
<path d="M 15 44 L 15 12 L 65 40 L 115 12 L 165 23 L 165 44 Z" fill="url(#grad_1653)" stroke="none"></path>
<path d="M 15 12 L 65 40 L 115 12 L 165 23" fill="none" stroke="#1f77b4" stroke-linecap="round" stroke-width="2"></path>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="8">96.3%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="34">91.6%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="8">96.3%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="17">94.5%</text>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="50">S45</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="50">S46</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="50">S48</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="50">Total</text>
<circle cx="165" cy="23" fill="#1f77b4" r="3.2"></circle>
</svg>
</td>
</tr>
</table></td>
<td valign="top" width="33.33%"><table border="0" cellpadding="0" cellspacing="0" class="tile-card" role="presentation">
<tr>
<h1>Frais</h1>
<td class="tile-left">
<div class="tile-name">Gonesse Flux Stock√©</div>
<div class="tile-value band-s3">93.3%</div>
</td>
<td class="tile-right">
<svg aria-label="sparkline" height="52" role="img" viewBox="0 0 180 52" width="180" xmlns="http://www.w3.org/2000/svg">
<defs>
<linearGradient id="grad_8446" x1="0" x2="0" y1="0" y2="1">
<stop offset="0%" stop-color="#1f77b4" stop-opacity="0.18"></stop>
<stop offset="100%" stop-color="#1f77b4" stop-opacity="0"></stop>
</linearGradient>
</defs>
<path d="M 15 44 L 15 12 L 65 40 L 115 18 L 165 20 L 165 44 Z" fill="url(#grad_8446)" stroke="none"></path>
<path d="M 15 12 L 65 40 L 115 18 L 165 20" fill="none" stroke="#1f77b4" stroke-linecap="round" stroke-width="2"></path>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="8">94.1%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="34">91.1%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="12">93.5%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="14">93.3%</text>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="50">S45</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="50">S46</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="50">S48</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="50">Total</text>
<circle cx="165" cy="20" fill="#1f77b4" r="3.2"></circle>
</svg>
</td>
</tr>
</table></td>
</tr>
<tr>
<td valign="top" width="33.33%"><table border="0" cellpadding="0" cellspacing="0" class="tile-card" role="presentation">
<tr>

<td class="tile-left">
<div class="tile-name">Direct Chennevi√®res</div>
<div class="tile-value band-s5">99.0%</div>
</td>
<td class="tile-right">
<svg aria-label="sparkline" height="52" role="img" viewBox="0 0 180 52" width="180" xmlns="http://www.w3.org/2000/svg">
<defs>
<linearGradient id="grad_208" x1="0" x2="0" y1="0" y2="1">
<stop offset="0%" stop-color="#1f77b4" stop-opacity="0.18"></stop>
<stop offset="100%" stop-color="#1f77b4" stop-opacity="0"></stop>
</linearGradient>
</defs>
<path d="M 15 44 L 15 40 L 65 12 L 115 40 L 165 33 L 165 44 Z" fill="url(#grad_208)" stroke="none"></path>
<path d="M 15 40 L 65 12 L 115 40 L 165 33" fill="none" stroke="#1f77b4" stroke-linecap="round" stroke-width="2"></path>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="34">98.8%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="8">99.6%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="34">98.8%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="27">99.0%</text>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="50">S45</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="50">S46</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="50">S48</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="50">Total</text>
<circle cx="165" cy="33" fill="#1f77b4" r="3.2"></circle>
</svg>
</td>
</tr>
</table></td>
<td valign="top" width="33.33%"><table border="0" cellpadding="0" cellspacing="0" class="tile-card" role="presentation">
<tr>

<td class="tile-left">
<div class="tile-name">Palette compl√®te Bonneuil</div>
<div class="tile-value band-s3">91.3%</div>
</td>
<td class="tile-right">
<svg aria-label="sparkline" height="52" role="img" viewBox="0 0 180 52" width="180" xmlns="http://www.w3.org/2000/svg">
<defs>
<linearGradient id="grad_3129" x1="0" x2="0" y1="0" y2="1">
<stop offset="0%" stop-color="#1f77b4" stop-opacity="0.18"></stop>
<stop offset="100%" stop-color="#1f77b4" stop-opacity="0"></stop>
</linearGradient>
</defs>
<path d="M 15 44 L 15 40 L 65 18 L 115 12 L 165 25 L 165 44 Z" fill="url(#grad_3129)" stroke="none"></path>
<path d="M 15 40 L 65 18 L 115 12 L 165 25" fill="none" stroke="#1f77b4" stroke-linecap="round" stroke-width="2"></path>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="34">90.9%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="12">91.5%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="8">91.6%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="19">91.3%</text>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="50">S45</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="50">S46</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="50">S48</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="50">Total</text>
<circle cx="165" cy="25" fill="#1f77b4" r="3.2"></circle>
</svg>
</td>
</tr>
</table></td>
<td valign="top" width="33.33%"></td>
</tr>
</table>

<div class="hr"></div>

<!-- Surtypologies -->
<div class="chart-title">Surtypologies</div>
<table border="0" cellpadding="6" cellspacing="0" class="tiles-grid-table" role="presentation" width="100%">
<tr>
<td valign="top" width="33.33%"><table border="0" cellpadding="0" cellspacing="0" class="tile-card" role="presentation">
<tr>

<td class="tile-left">
<div class="tile-name">LP</div>
<div class="tile-value band-s3">93.0%</div>
</td>
<td class="tile-right">
<svg aria-label="sparkline" height="52" role="img" viewBox="0 0 180 52" width="180" xmlns="http://www.w3.org/2000/svg">
<defs>
<linearGradient id="grad_7553" x1="0" x2="0" y1="0" y2="1">
<stop offset="0%" stop-color="#2ca02c" stop-opacity="0.18"></stop>
<stop offset="100%" stop-color="#2ca02c" stop-opacity="0"></stop>
</linearGradient>
</defs>
<path d="M 15 44 L 15 16 L 65 40 L 115 12 L 165 27 L 165 44 Z" fill="url(#grad_7553)" stroke="none"></path>
<path d="M 15 16 L 65 40 L 115 12 L 165 27" fill="none" stroke="#2ca02c" stroke-linecap="round" stroke-width="2"></path>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="10">94.8%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="34">90.8%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="8">95.4%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="21">93.0%</text>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="50">S45</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="50">S46</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="50">S48</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="50">Total</text>
<circle cx="165" cy="27" fill="#2ca02c" r="3.2"></circle>
</svg>
</td>
</tr>
</table></td>
<td valign="top" width="33.33%"><table border="0" cellpadding="0" cellspacing="0" class="tile-card" role="presentation">
<tr>

<td class="tile-left">
<div class="tile-name">MFP</div>
<div class="tile-value band-s3">93.4%</div>
</td>
<td class="tile-right">
<svg aria-label="sparkline" height="52" role="img" viewBox="0 0 180 52" width="180" xmlns="http://www.w3.org/2000/svg">
<defs>
<linearGradient id="grad_5065" x1="0" x2="0" y1="0" y2="1">
<stop offset="0%" stop-color="#2ca02c" stop-opacity="0.18"></stop>
<stop offset="100%" stop-color="#2ca02c" stop-opacity="0"></stop>
</linearGradient>
</defs>
<path d="M 15 44 L 15 15 L 65 40 L 115 12 L 165 22 L 165 44 Z" fill="url(#grad_5065)" stroke="none"></path>
<path d="M 15 15 L 65 40 L 115 12 L 165 22" fill="none" stroke="#2ca02c" stroke-linecap="round" stroke-width="2"></path>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="9">94.3%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="34">91.1%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="8">94.7%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="16">93.4%</text>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="50">S45</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="50">S46</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="50">S48</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="50">Total</text>
<circle cx="165" cy="22" fill="#2ca02c" r="3.2"></circle>
</svg>
</td>
</tr>
</table></td>
<td valign="top" width="33.33%"><table border="0" cellpadding="0" cellspacing="0" class="tile-card" role="presentation">
<tr>

<td class="tile-left">
<div class="tile-name">MN</div>
<div class="tile-value band-s3">94.4%</div>
</td>
<td class="tile-right">
<svg aria-label="sparkline" height="52" role="img" viewBox="0 0 180 52" width="180" xmlns="http://www.w3.org/2000/svg">
<defs>
<linearGradient id="grad_650" x1="0" x2="0" y1="0" y2="1">
<stop offset="0%" stop-color="#2ca02c" stop-opacity="0.18"></stop>
<stop offset="100%" stop-color="#2ca02c" stop-opacity="0"></stop>
</linearGradient>
</defs>
<path d="M 15 44 L 15 12 L 65 40 L 115 24 L 165 24 L 165 44 Z" fill="url(#grad_650)" stroke="none"></path>
<path d="M 15 12 L 65 40 L 115 24 L 165 24" fill="none" stroke="#2ca02c" stroke-linecap="round" stroke-width="2"></path>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="8">95.0%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="34">93.6%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="18">94.4%</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="18">94.4%</text>
<text fill="#6b7280" font-size="9" text-anchor="middle" x="15" y="50">S45</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="65" y="50">S46</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="115" y="50">S48</text><text fill="#6b7280" font-size="9" text-anchor="middle" x="165" y="50">Total</text>
<circle cx="165" cy="24" fill="#2ca02c" r="3.2"></circle>
</svg>
</td>
</tr>
</table></td>
</tr>
</table>

</td>
</tr>
</table>
</div>

<!-- ========== PAGE 2 : Tableau d√©taill√© ========== -->
<div class="page-break"></div>
<div class="wrap">

  <!-- Toolbar pour g√©rer les commentaires -->
  <div class="comment-toolbar">
    <button class="btn btn-success" onclick="saveComments()">üíæ Sauvegarder</button>
    <button class="btn" onclick="exportComments()">üì§ Exporter les commentaires</button>
    <button class="btn" onclick="importComments()">üì• Importer les commentaires</button>
    <button class="btn" onclick="clearAllComments()">üóëÔ∏è Effacer tout</button>
    <input type="file" id="importFile" accept=".json" style="display:none" onchange="handleImportFile(event)">
    <span class="status-msg" id="statusMsg"></span>
  </div>

  <header style="margin-bottom:8px;">
    <h1 style="font-size:18px; margin:0;">Indicateurs par cat√©gories : Taux de service | Taux de disponibilit√© | Taux de d√©tention Magasins</h1>
  </header>

  <div class="hr"></div>
  <div class="sub">
    <strong>Taux de service</strong> = 100 - Points perdus (base 100).
    <strong>Taux de disponibilit√©</strong> = part de r√©f√©rences commandables en entrep√¥t.
    <strong>D√©tention magasin</strong> = pr√©sence effective en rayon.
  </div>
  <div class="hr"></div>

  <table id="kpiTable">
    <thead>
      <tr>
        <th>Cat√©gorie</th>
        <th>Code Produit</th>
        <th>D√©signation</th>
        <th class="num">TS S-1</th>
        <th class="num">TS Global</th>
        <th class="num">D√©tention magasin</th>
        <th class="num">Taux de dispo</th>
        <th style="min-width: 200px;">Commentaire</th>
      </tr>
    </thead>
    <tbody>
<tr class="cat-row">
  <td colspan="4">Marqueur prix</td>
  <td class="num"><span class="b-na">-</span></td>
  <td class="num"><span class="b-na">-</span></td>
  <td class="num"><span class="b-na">-</span></td>
  <td></td>
</tr>

<tr class="cat-row">
  <td colspan="4">TOP 300 MDD</td>
  <td class="num"><span class="b-s1">22.2%</span></td>
  <td class="num"><span class="b-na">-</span></td>
  <td class="num"><span class="b-na">-</span></td>
  <td></td>
</tr>
<tr data-product-code="88124">
  <td></td>
  <td>88124</td>
  <td>LP ≈íUFS FRAIS SOL/MOY X30</td>
  <td class="num"><span class="b-s1">0.0%</span></td>
  <td class="num"><span class="b-s1">0.0%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="88124" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="64173">
  <td></td>
  <td>64173</td>
  <td>MFB ≈íUFS MOYEN X10 BIO 580G</td>
  <td class="num"><span class="b-s1">33.7%</span></td>
  <td class="num"><span class="b-s1">26.7%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="64173" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="88792">
  <td></td>
  <td>88792</td>
  <td>MFP ≈íUFS PLEIN AIR X12 876G</td>
  <td class="num"><span class="b-s1">36.7%</span></td>
  <td class="num"><span class="b-s1">17.8%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="88792" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="64120">
  <td></td>
  <td>64120</td>
  <td>MFB ≈íUFS BIO X6</td>
  <td class="num"><span class="b-s1">48.1%</span></td>
  <td class="num"><span class="b-s1">48.0%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="64120" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="64843">
  <td></td>
  <td>64843</td>
  <td>TABOULE ORIENTAL 300G</td>
  <td class="num"><span class="b-s1">41.9%</span></td>
  <td class="num"><span class="b-s1">26.8%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="64843" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="94579">
  <td></td>
  <td>94579</td>
  <td>LP SAUCISSON AIL 400G</td>
  <td class="num"><span class="b-s1">13.3%</span></td>
  <td class="num"><span class="b-s1">0.0%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="94579" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="64122">
  <td></td>
  <td>64122</td>
  <td>MFP 6 OEUFS PPA LABEL ROUGE</td>
  <td class="num"><span class="b-s1">68.1%</span></td>
  <td class="num"><span class="b-s1">33.9%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="64122" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="72802">
  <td></td>
  <td>72802</td>
  <td>MFP PUR JUS ORANGE 1L</td>
  <td class="num"><span class="b-s1">0.0%</span></td>
  <td class="num"><span class="b-s1">0.0%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="72802" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="90054">
  <td></td>
  <td>90054</td>
  <td>LP EAU VOLCANIA 6X1L5 PAL</td>
  <td class="num"><span class="b-s1">0.0%</span></td>
  <td class="num"><span class="b-s1">45.1%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="90054" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="94289">
  <td></td>
  <td>94289</td>
  <td>LP BOX ≈íUFS FRAIS SOL/MOY X30</td>
  <td class="num"><span class="b-s1">27.8%</span></td>
  <td class="num"><span class="b-s1">23.6%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="94289" placeholder="Ajouter un commentaire..."></td>
</tr>

<tr class="cat-row">
  <td colspan="4">TOP 300 MN</td>
  <td class="num"><span class="b-s1">31.0%</span></td>
  <td class="num"><span class="b-na">-</span></td>
  <td class="num"><span class="b-na">-</span></td>
  <td></td>
</tr>
<tr data-product-code="2062">
  <td></td>
  <td>2062</td>
  <td>MT ROUCOUS EAU MIN.NAT. 6X1L</td>
  <td class="num"><span class="b-s1">51.6%</span></td>
  <td class="num"><span class="b-s1">67.3%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="2062" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="68214">
  <td></td>
  <td>68214</td>
  <td>B.D'ICI ≈íUFS BLANC X20</td>
  <td class="num"><span class="b-s1">0.2%</span></td>
  <td class="num"><span class="b-s1">0.0%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="68214" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="88950">
  <td></td>
  <td>88950</td>
  <td>BOITE DE 30 ≈íUFS MOYENS</td>
  <td class="num"><span class="b-s1">16.7%</span></td>
  <td class="num"><span class="b-s1">31.9%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="88950" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="53536">
  <td></td>
  <td>53536</td>
  <td>LNA ≈íUFS PLEIN AIR X6 378G</td>
  <td class="num"><span class="b-s1">44.1%</span></td>
  <td class="num"><span class="b-s1">44.3%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="53536" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="84548">
  <td></td>
  <td>84548</td>
  <td>NOS ELEVEURS OEUFS BIO X10</td>
  <td class="num"><span class="b-s1">25.0%</span></td>
  <td class="num"><span class="b-s1">21.4%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="84548" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="94213">
  <td></td>
  <td>94213</td>
  <td>OEUF VILLAGE PL ENGAGES X12</td>
  <td class="num"><span class="b-s1">39.9%</span></td>
  <td class="num"><span class="b-s1">38.0%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="94213" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="68323">
  <td></td>
  <td>68323</td>
  <td>LNA ≈íUFS LABEL ROUGE X6</td>
  <td class="num"><span class="b-s1">19.9%</span></td>
  <td class="num"><span class="b-s1">37.8%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="68323" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="84567">
  <td></td>
  <td>84567</td>
  <td>OEUF VILLAGE SOL TERROIR X12</td>
  <td class="num"><span class="b-s1">27.1%</span></td>
  <td class="num"><span class="b-s1">27.2%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="84567" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="84569">
  <td></td>
  <td>84569</td>
  <td>OEUF VILLAGE SOL TERROIR X20</td>
  <td class="num"><span class="b-s1">22.0%</span></td>
  <td class="num"><span class="b-s1">21.9%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="84569" placeholder="Ajouter un commentaire..."></td>
</tr>
<tr data-product-code="94201">
  <td></td>
  <td>94201</td>
  <td>OEUF VILLAGE PL ENGAGES X6</td>
  <td class="num"><span class="b-s1">13.3%</span></td>
  <td class="num"><span class="b-s1">19.9%</span></td>
  <td class="num"></td>
  <td class="num"></td>
  <td><input type="text" class="comment-input" data-product="94201" placeholder="Ajouter un commentaire..."></td>
</tr>

<tr class="cat-row">
  <td colspan="4">Prix franc</td>
  <td class="num"><span class="b-na">-</span></td>
  <td class="num"><span class="b-na">-</span></td>
  <td class="num"><span class="b-na">-</span></td>
  <td></td>
</tr>
    </tbody>
  </table>
</div>

<div class="footer" style="padding:12px 24px; font-size:11px; color:#6b7280; text-align:center;">
  Newsletter g√©n√©r√©e automatiquement le 25/12/2025 16:32
</div>

<script>
// Syst√®me de gestion des commentaires
const STORAGE_KEY = 'kpi_comments';

// Charger les commentaires au d√©marrage
document.addEventListener('DOMContentLoaded', function() {
  loadComments();

  // Auto-save quand on tape dans un champ
  document.querySelectorAll('.comment-input').forEach(input => {
    input.addEventListener('input', function() {
      if (this.value.trim()) {
        this.classList.add('has-value');
      } else {
        this.classList.remove('has-value');
      }
    });
  });
});

// Charger les commentaires depuis localStorage
function loadComments() {
  try {
    const saved = localStorage.getItem(STORAGE_KEY);
    if (saved) {
      const comments = JSON.parse(saved);
      Object.keys(comments).forEach(productCode => {
        const input = document.querySelector(`input[data-product="${productCode}"]`);
        if (input) {
          input.value = comments[productCode];
          if (comments[productCode].trim()) {
            input.classList.add('has-value');
          }
        }
      });
      showStatus('Commentaires charg√©s', 'success');
    }
  } catch (e) {
    console.error('Erreur lors du chargement des commentaires:', e);
  }
}

// Sauvegarder les commentaires
function saveComments() {
  try {
    const comments = {};
    document.querySelectorAll('.comment-input').forEach(input => {
      const productCode = input.getAttribute('data-product');
      const value = input.value.trim();
      if (value) {
        comments[productCode] = value;
      }
    });

    localStorage.setItem(STORAGE_KEY, JSON.stringify(comments));
    showStatus('‚úì Commentaires sauvegard√©s !', 'success');
  } catch (e) {
    showStatus('‚úó Erreur lors de la sauvegarde', 'error');
    console.error('Erreur:', e);
  }
}

// Exporter les commentaires en JSON
function exportComments() {
  try {
    const comments = {};
    document.querySelectorAll('.comment-input').forEach(input => {
      const productCode = input.getAttribute('data-product');
      const value = input.value.trim();
      if (value) {
        comments[productCode] = value;
      }
    });

    const dataStr = JSON.stringify(comments, null, 2);
    const dataBlob = new Blob([dataStr], { type: 'application/json' });
    const url = URL.createObjectURL(dataBlob);
    const link = document.createElement('a');
    link.href = url;
    link.download = `kpi_comments_${new Date().toISOString().split('T')[0]}.json`;
    link.click();
    URL.revokeObjectURL(url);

    showStatus('‚úì Commentaires export√©s !', 'success');
  } catch (e) {
    showStatus('‚úó Erreur lors de l\'export', 'error');
    console.error('Erreur:', e);
  }
}

// Importer les commentaires
function importComments() {
  document.getElementById('importFile').click();
}

function handleImportFile(event) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(e) {
    try {
      const comments = JSON.parse(e.target.result);

      // Appliquer les commentaires import√©s
      Object.keys(comments).forEach(productCode => {
        const input = document.querySelector(`input[data-product="${productCode}"]`);
        if (input) {
          input.value = comments[productCode];
          if (comments[productCode].trim()) {
            input.classList.add('has-value');
          }
        }
      });

      // Sauvegarder automatiquement
      localStorage.setItem(STORAGE_KEY, JSON.stringify(comments));
      showStatus('‚úì Commentaires import√©s et sauvegard√©s !', 'success');
    } catch (e) {
      showStatus('‚úó Erreur lors de l\'import', 'error');
      console.error('Erreur:', e);
    }
  };
  reader.readAsText(file);

  // R√©initialiser l'input file
  event.target.value = '';
}

// Effacer tous les commentaires
function clearAllComments() {
  if (confirm('√ätes-vous s√ªr de vouloir effacer tous les commentaires ?')) {
    document.querySelectorAll('.comment-input').forEach(input => {
      input.value = '';
      input.classList.remove('has-value');
    });
    localStorage.removeItem(STORAGE_KEY);
    showStatus('‚úì Tous les commentaires ont √©t√© effac√©s', 'success');
  }
}

// Afficher un message de status
function showStatus(message, type = 'info') {
  const statusEl = document.getElementById('statusMsg');
  statusEl.textContent = message;
  statusEl.className = 'status-msg' + (type === 'success' ? ' success' : '');

  setTimeout(() => {
    statusEl.textContent = '';
    statusEl.className = 'status-msg';
  }, 3000);
}
</script>

</body>
</html>
